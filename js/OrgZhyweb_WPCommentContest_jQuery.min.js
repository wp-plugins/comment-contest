function commentContestDelete(e){jQuery("#comment-contest-"+e).removeClass("cheatComment"),jQuery("#comment-contest-"+e).addClass("removedComment"),jQuery("#restoreLink-"+e).show(),jQuery("#deleteLink-"+e).hide(),jQuery("#stopCheatLink-"+e).hide(),jQuery("#cheatLink-"+e).show()}function commentContestRestore(e){jQuery("#comment-contest-"+e).removeClass("removedComment"),jQuery("#deleteLink-"+e).show(),jQuery("#restoreLink-"+e).hide()}function commentContestCheat(e){jQuery("#comment-contest-"+e).removeClass("removedComment"),jQuery("#comment-contest-"+e).addClass("cheatComment"),jQuery("#stopCheatLink-"+e).show(),jQuery("#cheatLink-"+e).hide(),jQuery("#deleteLink-"+e).show(),jQuery("#restoreLink-"+e).hide()}function commentContestStopCheat(e){jQuery("#comment-contest-"+e).removeClass("cheatComment"),jQuery("#stopCheatLink-"+e).hide(),jQuery("#cheatLink-"+e).show()}function selectRole(e){jQuery("#contestForm tr").each(function(){var t=jQuery(this),r=t.find(".zhyweb_comment_contest_role").text(),n=r.split("|");jQuery.inArray(e,n)>=0&&r.length>0&&t.find('input[id^="cb-select"]').each(function(){jQuery(this).attr("checked",!0)})})}function fisherYates(e){var t=e.length;if(t>0)for(;--t;){var r=Math.floor(Math.random()*(t+1)),n=e[t],i=e[r];e[t]=i,e[r]=n}}function toggleFilters(e){var t=jQuery("#filters");t.fadeToggle("slow","linear",function(){t.is(":visible")?jQuery("#filtersImg").attr("src",e+"/img/minus.png"):jQuery("#filtersImg").attr("src",e+"/img/plus.png")})}jQuery(document).ready(function(){function e(e,t,r,n,i,o){var c=[],s=0;jQuery("#contestForm tr").each(function(){var o=jQuery(this),a=null;t&&(a=o.find(".zhyweb_comment_contest_alias").text());var u=null;r&&(u=o.find(".zhyweb_comment_contest_email").text());var m=null;if(n&&(m=o.find(".zhyweb_comment_contest_ip").text()),a||u||m){var l=0;jQuery("#contestForm tr").each(function(){if(l>s){var h=jQuery(this),y=null;t&&(y=h.find(".zhyweb_comment_contest_alias").text());var d=null;r&&(d=h.find(".zhyweb_comment_contest_email").text());var j=null;n&&(j=h.find(".zhyweb_comment_contest_ip").text()),a===y&&u===d&&m===j&&e.call(null,o,h)&&(i&&o.find('input[id^="cb-select"]').each(function(){var e=jQuery(this).val();-1===jQuery.inArray(e,c)&&c.push(e)}),h.find('input[id^="cb-select"]').each(function(){var e=jQuery(this).val();-1===jQuery.inArray(e,c)&&c.push(e)}))}l++})}s++}),c.sort(function(e,t){return e-t});for(var a=0;a<c.length;a++){var u=c[a];a>=o&&jQuery("#contestForm #cb-select-"+u).attr("checked",!0)}}function t(t){var r="alias"===t,n="email"===t,i="ip"===t;jQuery("#"+t+"AddressFilter").click(function(){jQuery("#zwpcc_"+t+"Filter_error_message").hide(),s(t+"Config");var c=jQuery("#"+t+"Config").val();jQuery.isNumeric(c)&&c>=0?e(function(e,r){var n=e.find(".zhyweb_comment_contest_"+t).text(),i=r.find(".zhyweb_comment_contest_"+t).text();return n===i},r,n,i,!0,c):(jQuery("#zwpcc_"+t+"Filter_error_message").show(),o(t+"Config"))})}function r(e){var t=jQuery("#words").val(),r=t.split(",");if(r.length>0){for(var n=0;n<r.length;n++)r[n]=r[n].trim().toLowerCase();jQuery("#contestForm tr").each(function(){for(var t=jQuery(this).find(".comment p").html(),n=e,i=0;i<r.length&&null!=t;i++){var o=r[i],c=t.toLowerCase().indexOf(o);if(e){if(-1===c){n=!1;break}}else if(c>=0){n=!0;break}}n||jQuery(this).find('input[id^="cb-select"]').attr("checked",!0)})}}function n(){jQuery('#contestForm input[id^="cb-select"]:checked').each(function(e,t){-1===t.id.indexOf("-all-")?commentContestDelete(jQuery(this).val()):jQuery(this).attr("checked",!1)})}function i(){jQuery('#contestForm input[id^="cb-select"]:checked').each(function(e,t){-1===t.id.indexOf("-all-")?commentContestRestore(jQuery(this).val()):jQuery(this).attr("checked",!1)})}function o(e){jQuery("#"+e).css("border","2px solid red")}function c(e){e.css("border","1px solid rgb(223,223,223)")}function s(e){c(jQuery("#"+e))}t("ip"),t("email"),t("alias"),jQuery("#timeBetweenFilter").click(function(){jQuery("#zwpcc_timeBetweenFilter_error_message").hide(),s("timeBetween");var t=jQuery("#timeBetween").val();if(jQuery.isNumeric(t)&&t>0){var r=jQuery("#timeBetweenFilterName").is(":checked"),n=jQuery("#timeBetweenFilterEmail").is(":checked"),i=jQuery("#timeBetweenFilterIP").is(":checked");if(r||n||i){var c=60*t;e(function(e,t){var r=e.find(".zhyweb_comment_contest_timestamp").text(),n=t.find(".zhyweb_comment_contest_timestamp").text(),i=Math.abs(r-n)-c;return 0>=i},r,n,i,!1,0)}else jQuery("#zwpcc_timeBetweenFilter_error_message").show()}else jQuery("#zwpcc_timeBetweenFilter_error_message").show(),o("timeBetween")}),jQuery("#datepicker").datepicker(),jQuery("#dateSubmit").click(function(){jQuery("#zwpcc_dateFilter_error_message").hide(),s("datepicker"),s("dateHours"),s("dateMinutes");var e=!1,t=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,r=jQuery("#datepicker").val(),n="",i="",c="";if(t.test(r)){var a=t.exec(r);n=a[1],i=a[2],c=a[3],n>0&&13>n&&i>0&&32>i&&c>0&&(e=!0)}if(e){var u=jQuery("#dateHours").val(),m=jQuery("#dateMinutes").val();""!==u&&u>=0&&24>u&&""!==m&&m>=0&&60>m?jQuery("#contestForm tr").each(function(){var e=jQuery(this),t=e.find(".zhyweb_comment_contest_date").text();if(""!==t){var r=c+n+i+u+m;t>r&&e.find('input[id^="cb-select"]').each(function(){jQuery(this).attr("checked",!0)})}}):(jQuery("#zwpcc_dateFilter_error_message").show(),o("dateHours"),o("dateMinutes"))}else jQuery("#zwpcc_dateFilter_error_message").show(),o("datepicker")}),jQuery("#wordsFilter").click(function(){r(!1)}),jQuery("#allWordsFilter").click(function(){r(!0)}),jQuery(".help").tipTip({attribute:"title",fadeIn:50,fadeOut:50,keepAlive:!0,activation:"hover",maxWidth:400}),jQuery(".help").tipTip(),jQuery("#contestForm #doaction").click(function(){"delete"===jQuery('#contestForm select[name="action"]').val()&&n()}),jQuery("#contestForm #doaction2").click(function(){"delete"===jQuery('#contestForm select[name="action2"]').val()&&n()}),jQuery("#contestForm #doaction").click(function(){"restore"===jQuery('#contestForm select[name="action"]').val()&&i()}),jQuery("#contestForm #doaction2").click(function(){"restore"===jQuery('#contestForm select[name="action2"]').val()&&i()}),jQuery("#dialog-modal-winners").dialog({height:500,width:800,modal:!0,autoOpen:!1,dialogClass:"wp-dialog",open:function(){var e=jQuery("#zwpcc_nb_winners").val(),t=new Array,r=new Array;jQuery("#contestForm tr").each(function(){var e=jQuery(this);if(!e.hasClass("removedComment")){var n=e.find(".zhyweb_comment_contest_id").html();null!=n&&""!==n&&(e.hasClass("cheatComment")?r.push(n):t.push(n))}}),jQuery('#dialog-modal-winners tr[id^="result-comment-contest"]').each(function(){jQuery(this).hide()}),fisherYates(r),r.length<e&&fisherYates(t);for(var n=jQuery.merge(r,t),i=0;e>i&&i<n.length;i++)jQuery("#result-comment-contest-"+n[i]).show(),i>=1&&jQuery("#result-comment-contest-"+n[i-1]).after(jQuery("#result-comment-contest-"+n[i]))}}),jQuery("#zwpcc_form").submit(function(){launch=!0,jQuery("#zwpcc_nbWinners_error_message").hide(),jQuery(this).find("input").each(function(){c(jQuery(this))}),jQuery("#winners-message-ok").hide(),jQuery("#winners-message-error").hide();var e=jQuery("#zwpcc_nb_winners").val();return(!jQuery.isNumeric(e)||0>=e)&&(launch=!1,o("zwpcc_nb_winners"),jQuery("#zwpcc_nbWinners_error_message").show()),launch&&jQuery("#dialog-modal-winners").dialog("open"),!1}),jQuery(".saveWinnersButton").click(function(){var e=[];jQuery("#dialog-modal-winners table tr").each(function(){var t=jQuery(this),r=t.find(".zhyweb_comment_contest_id").text();r&&t.is(":visible")&&e.push(r)});var t=jQuery.post("../wp-content/plugins/comment-contest/php/OrgZhyweb_WPCommentContest_SaveWinners.php",{winners:e.join(","),post:jQuery("#zwpcc_postID").text()});t.fail(function(e){jQuery("#winners-message-ok").hide(),jQuery("#winners-message-error").show(),jQuery("#winners-message-error-msg").text(e)}),t.done(function(){jQuery("#winners-message-error").hide(),jQuery("#winners-message-ok").show()})})});